# n8n

> `[2] 입문` · 선수 지식: 없음 (노코드), JavaScript 기초 (커스텀 로직 시)

> 셀프 호스팅이 가능한 오픈소스 워크플로우 자동화 플랫폼

`#n8n` `#워크플로우` `#Workflow` `#자동화` `#Automation` `#노코드` `#NoCode` `#로우코드` `#LowCode` `#오픈소스` `#OpenSource` `#Zapier대안` `#셀프호스팅` `#SelfHosted` `#Docker` `#API통합` `#Integration` `#트리거` `#Trigger` `#웹훅` `#Webhook` `#크론` `#Cron` `#노드기반` `#시각적워크플로우` `#업무자동화` `#iPaaS`

## 왜 알아야 하는가?

- **실무**: Zapier 비용 절감, 민감한 데이터의 사내 처리, 복잡한 워크플로우 구현
- **면접**: 자동화 도구 선택 기준, 오픈소스 활용 경험, 비용 최적화 사례
- **기반 지식**: 워크플로우 자동화 패턴, 이벤트 기반 아키텍처, API 연동 이해

## 핵심 개념

- **노드(Node)**: 워크플로우의 각 작업 단위 (트리거, 액션, 조건 등)
- **워크플로우(Workflow)**: 노드들의 연결로 구성된 자동화 흐름
- **트리거(Trigger)**: 워크플로우를 시작하는 이벤트 (웹훅, 스케줄, 수동)
- **크레덴셜(Credential)**: 외부 서비스 인증 정보 관리

## 쉽게 이해하기

**레고 블록으로 자동화 만들기**

```
┌─────────────────────────────────────────────────────────────┐
│                     n8n 워크플로우                           │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   [트리거]      [처리]       [조건]       [액션]            │
│   ┌─────┐      ┌─────┐      ┌─────┐      ┌─────┐           │
│   │ 📥  │ ──► │ 🔄  │ ──► │ ❓  │ ──► │ 📤  │           │
│   │웹훅 │      │변환 │      │분기 │      │전송 │           │
│   └─────┘      └─────┘      └─────┘      └─────┘           │
│                                    │                        │
│                                    └──► [다른 액션]         │
│                                                              │
│   각 블록(노드)을 드래그 & 연결하면 자동화 완성!            │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**비유**: n8n은 "자동화의 레고"
- 블록(노드)을 조립하듯 연결
- 코드 없이 복잡한 흐름 구현
- 필요하면 코드 블록 추가 가능

## 상세 설명

### n8n 아키텍처

```
┌────────────────────────────────────────────────────────────────┐
│                      n8n 아키텍처                               │
├────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────────────────────────────────────────────────┐      │
│   │                    n8n Server                        │      │
│   │  ┌───────────┐  ┌───────────┐  ┌───────────┐       │      │
│   │  │  Editor   │  │  Worker   │  │  Webhook  │       │      │
│   │  │   (UI)    │  │ (실행기)  │  │ (수신기)  │       │      │
│   │  └───────────┘  └───────────┘  └───────────┘       │      │
│   └─────────────────────────────────────────────────────┘      │
│                              │                                  │
│              ┌───────────────┼───────────────┐                 │
│              ▼               ▼               ▼                 │
│   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐        │
│   │   Database   │  │  Credential  │  │   외부 API   │        │
│   │  (SQLite/    │  │    Store     │  │  (Slack,     │        │
│   │   Postgres)  │  │  (암호화)    │  │   GitHub...) │        │
│   └──────────────┘  └──────────────┘  └──────────────┘        │
│                                                                 │
└────────────────────────────────────────────────────────────────┘
```

### 배포 옵션

| 옵션 | 설명 | 적합한 경우 |
|------|------|------------|
| **n8n.cloud** | 관리형 SaaS | 빠른 시작, 소규모 팀 |
| **Docker** | 컨테이너 배포 | 개발/테스트, 단일 서버 |
| **Kubernetes** | 오케스트레이션 | 대규모, 고가용성 필요 |
| **npm** | 직접 설치 | 커스텀 환경 |

### 노드 종류

```
┌────────────────────────────────────────────────────────────────┐
│                      노드 카테고리                              │
├────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 트리거 노드 (Trigger)                                      │
│     - Webhook: HTTP 요청 수신                                  │
│     - Schedule: Cron 기반 스케줄                               │
│     - 앱별 트리거: Gmail, Slack, GitHub 등                     │
│                                                                 │
│  2. 일반 노드 (Regular)                                        │
│     - HTTP Request: API 호출                                   │
│     - 앱 노드: 400+ 서비스 연동                                │
│     - Function: JavaScript 커스텀 로직                         │
│                                                                 │
│  3. 흐름 제어 노드 (Flow)                                      │
│     - IF: 조건 분기                                            │
│     - Switch: 다중 분기                                        │
│     - Merge: 여러 흐름 합치기                                  │
│     - Split In Batches: 배치 처리                              │
│                                                                 │
│  4. 데이터 노드 (Transform)                                    │
│     - Set: 데이터 설정                                         │
│     - Code: JavaScript/Python 실행                             │
│     - Item Lists: 배열 조작                                    │
│                                                                 │
└────────────────────────────────────────────────────────────────┘
```

## 예제 워크플로우

### 1. GitHub Issue → Slack 알림

```
┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│   GitHub     │    │     Set      │    │    Slack     │
│   Trigger    │───►│   (가공)     │───►│   (알림)     │
│              │    │              │    │              │
│ On Issue     │    │ 메시지 포맷  │    │ #dev 채널    │
│ Created      │    │ 생성         │    │ 전송         │
└──────────────┘    └──────────────┘    └──────────────┘
```

**Set 노드 설정 (JSON)**:
```json
{
  "message": "새 이슈: {{ $json.issue.title }}",
  "url": "{{ $json.issue.html_url }}",
  "author": "{{ $json.issue.user.login }}"
}
```

### 2. 스케줄 기반 데이터 수집

```
┌──────────────┐    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│   Schedule   │    │    HTTP      │    │    Code      │    │   Google     │
│   Trigger    │───►│   Request    │───►│   (변환)     │───►│   Sheets     │
│              │    │              │    │              │    │              │
│ 매일 9시     │    │ API 호출     │    │ 데이터 가공  │    │ 행 추가      │
└──────────────┘    └──────────────┘    └──────────────┘    └──────────────┘
```

**Code 노드 (JavaScript)**:
```javascript
// 입력 데이터 가공
const items = $input.all();

return items.map(item => {
  return {
    json: {
      date: new Date().toISOString().split('T')[0],
      value: item.json.data.value,
      change: ((item.json.data.value - item.json.data.previous) / item.json.data.previous * 100).toFixed(2) + '%'
    }
  };
});
```

### 3. 웹훅 → 조건 분기 → 다중 액션

```
                                    ┌──────────────┐
                               ┌───►│    Slack     │
                               │    │  (긴급 알림) │
┌──────────────┐    ┌─────┐    │    └──────────────┘
│   Webhook    │───►│ IF  │────┤
│   Trigger    │    │     │    │    ┌──────────────┐
│              │    │     │    └───►│    Email     │
│ POST /alert  │    │     │         │  (일반 알림) │
└──────────────┘    └─────┘         └──────────────┘
                       │
                 priority === 'high'
                    ? Slack
                    : Email
```

### 4. 에러 처리 패턴

```
┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│   Trigger    │───►│    HTTP      │───►│   Success    │
│              │    │   Request    │    │   Action     │
└──────────────┘    └──────┬───────┘    └──────────────┘
                           │
                           │ Error
                           ▼
                    ┌──────────────┐    ┌──────────────┐
                    │    Error     │───►│   Slack      │
                    │   Trigger    │    │  (에러 알림) │
                    └──────────────┘    └──────────────┘
```

## Docker로 시작하기

### 빠른 시작

```bash
# 단일 컨테이너 실행
docker run -it --rm \
  --name n8n \
  -p 5678:5678 \
  -v n8n_data:/home/node/.n8n \
  n8nio/n8n
```

### docker-compose.yml

```yaml
version: '3.8'

services:
  n8n:
    image: n8nio/n8n
    restart: always
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=password
      - N8N_HOST=n8n.example.com
      - N8N_PROTOCOL=https
      - WEBHOOK_URL=https://n8n.example.com/
      - GENERIC_TIMEZONE=Asia/Seoul
    volumes:
      - n8n_data:/home/node/.n8n

volumes:
  n8n_data:
```

### 프로덕션 설정 (PostgreSQL)

```yaml
version: '3.8'

services:
  n8n:
    image: n8nio/n8n
    environment:
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=postgres
      - DB_POSTGRESDB_PORT=5432
      - DB_POSTGRESDB_DATABASE=n8n
      - DB_POSTGRESDB_USER=n8n
      - DB_POSTGRESDB_PASSWORD=n8n_password
      - EXECUTIONS_DATA_PRUNE=true
      - EXECUTIONS_DATA_MAX_AGE=168  # 7일
    depends_on:
      - postgres

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_DB=n8n
      - POSTGRES_USER=n8n
      - POSTGRES_PASSWORD=n8n_password
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  n8n_data:
  postgres_data:
```

## 트레이드오프

### n8n vs 다른 자동화 도구

| 항목 | n8n | Zapier | Make | Apps Script |
|------|-----|--------|------|-------------|
| **비용** | 셀프호스팅 무료 | $20~/월 | $9~/월 | 무료 |
| **셀프호스팅** | 가능 | 불가 | 불가 | 불가 |
| **데이터 보안** | 내 서버 | 외부 | 외부 | Google |
| **노드/연동 수** | 400+ | 6000+ | 1500+ | Google 전용 |
| **복잡한 로직** | JavaScript | 제한적 | 제한적 | JavaScript |
| **학습 곡선** | 중간 | 낮음 | 낮음 | 중간 |
| **커뮤니티** | 오픈소스 | 상용 | 상용 | Google |

### 언제 n8n을 선택하는가?

```
┌─────────────────────────────────────────────────────────────┐
│                      선택 가이드                             │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  n8n 선택                          Zapier/Make 선택         │
│  ─────────                         ───────────────          │
│  ✓ 데이터 보안이 중요              ✓ 빠른 시작 필요         │
│  ✓ 비용 최소화 필요                ✓ 인프라 관리 불가       │
│  ✓ 복잡한 커스텀 로직              ✓ 간단한 자동화          │
│  ✓ 셀프호스팅 인프라 있음          ✓ SLA/지원 필요          │
│  ✓ 오픈소스 선호                   ✓ 비개발자 사용          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### n8n 제한사항

| 항목 | 제한 |
|------|------|
| 메모리 | 워크플로우당 ~256MB (기본) |
| 실행 시간 | 타임아웃 설정 가능 (기본 무제한) |
| 동시 실행 | 워커 수에 따라 제한 |
| 웹훅 | 인스턴스당 제한 없음 |

## 실무 활용 패턴

### 자주 사용되는 시나리오

```
┌────────────────────────────────────────────────────────────────┐
│                   실무 자동화 시나리오                          │
├────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. 리드 관리                                                  │
│     Form 제출 → CRM 저장 → 영업팀 Slack 알림 → 이메일 발송    │
│                                                                 │
│  2. 인시던트 대응                                              │
│     모니터링 웹훅 → 심각도 분류 → PagerDuty/Slack 알림        │
│                                                                 │
│  3. 콘텐츠 배포                                                │
│     RSS 피드 → 요약 생성 (AI) → 소셜 미디어 자동 포스팅       │
│                                                                 │
│  4. 데이터 동기화                                              │
│     DB 변경 감지 → 데이터 변환 → 외부 시스템 동기화           │
│                                                                 │
│  5. 보고서 자동화                                              │
│     스케줄 트리거 → 여러 API 데이터 수집 → 리포트 생성        │
│                                                                 │
└────────────────────────────────────────────────────────────────┘
```

## 면접 예상 질문

### Q: Zapier 대신 n8n을 선택한 이유는?

A: 세 가지 핵심 이유가 있습니다.

1. **데이터 보안**: 고객 데이터가 외부 SaaS로 나가면 안 되는 규정 준수 요구사항. n8n 셀프호스팅으로 데이터가 사내 서버에만 존재
2. **비용 효율**: Zapier Task 기반 과금은 규모가 커지면 월 수백만원. n8n은 EC2 비용만 발생
3. **복잡한 로직**: JavaScript Code 노드로 Zapier에서 불가능한 복잡한 데이터 변환 구현

**트레이드오프**: 인프라 관리 부담이 생겼지만, Docker + 모니터링으로 운영 안정화

### Q: n8n 워크플로우 에러 처리 전략은?

A: 세 가지 레벨로 처리합니다.

1. **노드 레벨**: 각 노드에 "Continue On Fail" 설정, 에러 발생해도 다음 노드 실행
2. **워크플로우 레벨**: Error Trigger 노드로 에러 발생 시 별도 흐름 실행 (알림 발송)
3. **시스템 레벨**: 실행 로그 모니터링, 실패율 임계치 초과 시 경고

```
// Error Trigger 활용 예시
Workflow Error → Error Trigger → Slack 알림 + DB 로깅
```

### Q: n8n 성능 최적화 방법은?

A: 주요 최적화 포인트입니다.

1. **배치 처리**: Split In Batches 노드로 대량 데이터 청크 단위 처리
2. **병렬 실행**: 독립적인 노드는 병렬로 실행되도록 워크플로우 설계
3. **데이터 필터링**: 불필요한 데이터 조기 필터링으로 메모리 사용 감소
4. **Queue 모드**: 대규모 처리 시 Redis + Worker 구조로 확장

## 연관 문서

| 문서 | 연관성 | 난이도 |
|------|--------|--------|
| [Google Apps Script](./google-apps-script.md) | 다른 자동화 도구 비교 | 입문 |
| CI/CD 자동화 (TODO) | n8n + GitHub Actions 연동 | 중급 |
| 웹훅 | 트리거 이해 | 입문 |

## 참고 자료

- [n8n 공식 문서](https://docs.n8n.io/)
- [n8n 커뮤니티 노드](https://n8n.io/integrations)
- [n8n GitHub](https://github.com/n8n-io/n8n)
- [n8n 워크플로우 템플릿](https://n8n.io/workflows)
