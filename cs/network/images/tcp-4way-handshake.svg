<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 400">
  <defs>
    <linearGradient id="clientN" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3498DB"/>
      <stop offset="100%" style="stop-color:#2980B9"/>
    </linearGradient>
    <linearGradient id="serverN" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2ECC71"/>
      <stop offset="100%" style="stop-color:#27AE60"/>
    </linearGradient>
    <marker id="arrR" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#E74C3C"/>
    </marker>
    <marker id="arrL" markerWidth="10" markerHeight="7" refX="1" refY="3.5" orient="auto">
      <polygon points="10 0, 0 3.5, 10 7" fill="#3498DB"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="250" y="25" text-anchor="middle" fill="#2C3E50" font-family="Arial, sans-serif" font-size="14" font-weight="bold">4-way Handshake (연결 종료)</text>

  <!-- Client/Server labels -->
  <rect x="80" y="40" width="80" height="30" fill="url(#clientN)" rx="5"/>
  <text x="120" y="60" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Client</text>

  <rect x="340" y="40" width="80" height="30" fill="url(#serverN)" rx="5"/>
  <text x="380" y="60" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Server</text>

  <!-- Vertical lines -->
  <line x1="120" y1="70" x2="120" y2="340" stroke="#3498DB" stroke-width="3"/>
  <line x1="380" y1="70" x2="380" y2="340" stroke="#2ECC71" stroke-width="3"/>

  <!-- Step 1: FIN -->
  <line x1="120" y1="100" x2="370" y2="100" stroke="#E74C3C" stroke-width="2" marker-end="url(#arrR)"/>
  <rect x="200" y="85" width="100" height="22" fill="#E74C3C" rx="3"/>
  <text x="250" y="100" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">FIN</text>
  <text x="405" y="100" fill="#7F8C8D" font-family="Arial, sans-serif" font-size="9">1. 종료 요청</text>

  <!-- Step 2: ACK -->
  <line x1="380" y1="145" x2="130" y2="145" stroke="#3498DB" stroke-width="2" marker-end="url(#arrL)"/>
  <rect x="200" y="130" width="100" height="22" fill="#3498DB" rx="3"/>
  <text x="250" y="145" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">ACK</text>
  <text x="35" y="145" fill="#7F8C8D" font-family="Arial, sans-serif" font-size="9">2. 알겠음</text>

  <!-- Step 3: FIN -->
  <line x1="380" y1="200" x2="130" y2="200" stroke="#3498DB" stroke-width="2" marker-end="url(#arrL)"/>
  <rect x="200" y="185" width="100" height="22" fill="#E67E22" rx="3"/>
  <text x="250" y="200" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">FIN</text>
  <text x="35" y="200" fill="#7F8C8D" font-family="Arial, sans-serif" font-size="9">3. 나도 종료</text>

  <!-- Step 4: ACK -->
  <line x1="120" y1="250" x2="370" y2="250" stroke="#E74C3C" stroke-width="2" marker-end="url(#arrR)"/>
  <rect x="200" y="235" width="100" height="22" fill="#9B59B6" rx="3"/>
  <text x="250" y="250" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">ACK</text>
  <text x="405" y="250" fill="#7F8C8D" font-family="Arial, sans-serif" font-size="9">4. 확인</text>

  <!-- TIME_WAIT -->
  <rect x="70" y="275" width="100" height="35" fill="#F1C40F" rx="4" fill-opacity="0.3" stroke="#F1C40F"/>
  <text x="120" y="295" text-anchor="middle" fill="#7D6608" font-family="Arial, sans-serif" font-size="9">TIME_WAIT</text>
  <text x="120" y="305" text-anchor="middle" fill="#7D6608" font-family="Arial, sans-serif" font-size="8">(2*MSL)</text>

  <!-- Connection closed -->
  <line x1="100" y1="330" x2="400" y2="330" stroke="#E74C3C" stroke-width="3" stroke-dasharray="10,5"/>
  <text x="250" y="350" text-anchor="middle" fill="#E74C3C" font-family="Arial, sans-serif" font-size="11" font-weight="bold">연결 종료 완료</text>
</svg>